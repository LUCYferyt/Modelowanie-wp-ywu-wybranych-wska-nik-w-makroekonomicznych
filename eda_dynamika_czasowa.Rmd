---
title: "Eksploracyjna analiza danych – dynamika czasowa"
author: "Łucja Wuls"
date: "2025-11-18"
---

# Wstęp

Celem tego notebooka jest zbadanie dynamiki czasowej ruchu turystycznego oraz wybranych wskaźników makroekonomicznych w zbiorze `world_tourism_economy_data_clean.csv`.
Skupiamy się na analizie zmian w czasie:
- na poziomie globalnym (agregacja po latach),
- na poziomie wybranych krajów (studia przypadków),
- w ujęciu stóp wzrostu (dynamiki rok do roku).

Wyniki tej części EDA będą później wykorzystane przy wyborze odpowiednich form zmiennych (poziomy vs dynamiki) w modelach.

# Przygotowanie środowiska

```{r}
knitr::opts_chunk$set(
  echo = TRUE,
  message = FALSE,
  warning = FALSE
)
```

```{r}
# Pakiety potrzebne w tej części EDA.
# tidyverse – dplyr, tidyr, ggplot2 itd.

library(tidyverse)
```

# Wczytanie danych

```{r}
# Ścieżka do wyczyszczonego zbioru danych.
clean_path <- "data/clean/world_tourism_economy_data_clean.csv"

# Wczytanie danych.
tourism <- readr::read_csv(clean_path, show_col_types = FALSE)

# Kontrolny podgląd struktury.
glimpse(tourism)
```

# Globalna dynamika ruchu turystycznego i PKB

W tej sekcji analizujemy, jak kształtują się podstawowe zmienne w czasie na poziomie całego świata (agregacja po latach).

## Agregacja danych po latach

```{r}
# Agregujemy dane po roku.

global_year <- tourism %>%
  group_by(year) %>%
  summarise(
    sum_arrivals    = sum(tourism_arrivals, na.rm = TRUE),
    sum_receipts    = sum(tourism_receipts, na.rm = TRUE),
    sum_gdp         = sum(gdp, na.rm = TRUE),
    mean_arrivals   = mean(tourism_arrivals, na.rm = TRUE),
    mean_receipts   = mean(tourism_receipts, na.rm = TRUE),
    mean_gdp        = mean(gdp, na.rm = TRUE),
    .groups = "drop"
  )

global_year
```

## Globalna liczba przyjazdów turystów w czasie

```{r}
# Wykres globalnej liczby przyjazdów turystów w czasie (suma po wszystkich krajach).

global_year %>%
  ggplot(aes(x = year, y = sum_arrivals)) +
  geom_line() +
  labs(
    x = "Rok",
    y = "Globalna liczba przyjazdów (suma)",
    title = "Globalna dynamika liczby przyjazdów turystów w czasie"
  )
```

## Globalne wpływy z turystyki w czasie

```{r}
# Wykres globalnych wpływów z turystyki w czasie.

global_year %>%
  ggplot(aes(x = year, y = sum_receipts)) +
  geom_line() +
  labs(
    x = "Rok",
    y = "Globalne wpływy z turystyki (suma)",
    title = "Globalna dynamika wpływów z turystyki w czasie"
  )
```

## Globalny PKB a ruch turystyczny

```{r}
# Wykres globalnego PKB w czasie.

global_year %>%
  ggplot(aes(x = year, y = sum_gdp)) +
  geom_line() +
  labs(
    x = "Rok",
    y = "Globalny PKB (suma)",
    title = "Globalna dynamika PKB w czasie"
  )
```

# Dynamika czasowa – studia przypadków dla wybranych krajów

W tej części analizujemy profile czasowe kilku reprezentatywnych krajów, aby zobaczyć, jak różne mogą być ścieżki rozwoju turystyki przy różnej sytuacji gospodarczej.

## Wybór krajów do analizy

```{r}
# Wektor wybranych krajów do szczegółowej analizy.

selected_countries <- c(
  "Spain",
  "France",
  "United States",
  "Poland",
  "Turkiye"
)

tourism_sel <- tourism %>%
  filter(country %in% selected_countries)

unique(tourism_sel$country)
```

## Liczba przyjazdów w czasie – wybrane kraje

```{r}
# Wykres liczby przyjazdów w czasie dla wybranych krajów.

tourism_sel %>%
  ggplot(aes(x = year, y = tourism_arrivals, color = country)) +
  geom_line() +
  labs(
    x = "Rok",
    y = "Liczba przyjazdów turystów",
    color = "Kraj",
    title = "Dynamika liczby przyjazdów w czasie – wybrane kraje"
  )
```

## Wpływy z turystyki i PKB w czasie – wybrane kraje

```{r}
# Wykres wpływów z turystyki w czasie dla wybranych krajów.

tourism_sel %>%
  ggplot(aes(x = year, y = tourism_receipts, color = country)) +
  geom_line() +
  labs(
    x = "Rok",
    y = "Wpływy z turystyki",
    color = "Kraj",
    title = "Dynamika wpływów z turystyki w czasie – wybrane kraje"
  )
```

```{r}
# Wykres PKB w czasie dla wybranych krajów.

tourism_sel %>%
  ggplot(aes(x = year, y = gdp, color = country)) +
  geom_line() +
  labs(
    x = "Rok",
    y = "PKB",
    color = "Kraj",
    title = "Dynamika PKB w czasie – wybrane kraje"
  )
```

# Dynamika w ujęciu stóp wzrostu

Sam poziom wskaźników nie mówi jeszcze o tempie zmian.
Dlatego przydatne jest obliczenie stóp wzrostu rok do roku (dynamik) i ich analiza.

## Wyznaczenie stóp wzrostu rok do roku

```{r}
# Obliczamy stopy wzrostu w obrębie krajów:
# growth_x_it = (x_it - x_i,t-1) / x_i,t-1.

tourism_panel <- tourism %>%
  arrange(country, country_code, year) %>%
  group_by(country, country_code) %>%
  mutate(
    growth_arrivals = (tourism_arrivals - lag(tourism_arrivals)) / lag(tourism_arrivals),
    growth_receipts = (tourism_receipts - lag(tourism_receipts)) / lag(tourism_receipts),
    growth_gdp      = (gdp - lag(gdp)) / lag(gdp)
  ) %>%
  ungroup()

tourism_panel %>%
  select(country, year, growth_arrivals, growth_gdp) %>%
  head()
```

## Rozkład stóp wzrostu liczby przyjazdów

```{r}
# Histogram stóp wzrostu liczby przyjazdów (globalnie, dla wszystkich krajów).

tourism_panel %>%
  ggplot(aes(x = growth_arrivals)) +
  geom_histogram(bins = 50) +
  labs(
    x = "Stopa wzrostu liczby przyjazdów (r/r)",
    y = "Liczba obserwacji",
    title = "Rozkład rocznych stóp wzrostu liczby przyjazdów"
  )
```

```{r}
# Boxplot stóp wzrostu liczby przyjazdów – przydatny do identyfikacji wartości skrajnych.

tourism_panel %>%
  ggplot(aes(y = growth_arrivals)) +
  geom_boxplot() +
  labs(
    y = "Stopa wzrostu liczby przyjazdów (r/r)",
    title = "Rozkład stóp wzrostu liczby przyjazdów – boxplot"
  )
```

## Przykładowe profile stóp wzrostu dla wybranych krajów

```{r}
# Stopy wzrostu dla wcześniej wybranych krajów.

tourism_panel_sel <- tourism_panel %>%
  filter(country %in% selected_countries)

tourism_panel_sel %>%
  ggplot(aes(x = year, y = growth_arrivals, color = country)) +
  geom_line() +
  labs(
    x = "Rok",
    y = "Stopa wzrostu liczby przyjazdów (r/r)",
    color = "Kraj",
    title = "Dynamika stóp wzrostu liczby przyjazdów – wybrane kraje"
  )
```

```{r}
# Analogicznie: stopy wzrostu PKB dla wybranych krajów.

tourism_panel_sel %>%
  ggplot(aes(x = year, y = growth_gdp, color = country)) +
  geom_line() +
  labs(
    x = "Rok",
    y = "Stopa wzrostu PKB (r/r)",
    color = "Kraj",
    title = "Dynamika stóp wzrostu PKB – wybrane kraje"
  )
```

# Analiza epizodów kryzysowych (opcjonalnie)

W tej sekcji można dodatkowo porównać średnie stopy wzrostu w okresach „normalnych” i kryzysowych.

```{r}
# Definiujemy proste przedziały czasowe dla przykładowych epizodów kryzysowych.
# Lata 2008–2009 jako kryzys finansowy, rok 2020 jako pandemia.

tourism_panel <- tourism_panel %>%
  mutate(
    period_label = case_when(
      year %in% 2008:2009 ~ "kryzys_finansowy_2008_2009",
      year == 2020        ~ "pandemia_2020",
      TRUE                ~ "okres_pozostaly"
    )
  )

# Średnie stopy wzrostu liczby przyjazdów w poszczególnych okresach.
crisis_summary <- tourism_panel %>%
  group_by(period_label) %>%
  summarise(
    mean_growth_arrivals = mean(growth_arrivals, na.rm = TRUE),
    mean_growth_gdp      = mean(growth_gdp, na.rm = TRUE),
    .groups = "drop"
  )

crisis_summary
```

```{r}
# Wykres słupkowy porównujący średnie stopy wzrostu liczby przyjazdów w okresach kryzysowych i poza kryzysami.

crisis_summary %>%
  ggplot(aes(x = period_label, y = mean_growth_arrivals)) +
  geom_col() +
  labs(
    x = "Okres",
    y = "Średnia stopa wzrostu liczby przyjazdów (r/r)",
    title = "Średnie stopy wzrostu liczby przyjazdów w okresach kryzysowych i pozostałych"
  )
```

# Podsumowanie

W tym notebooku:
- przeanalizowano globalną dynamikę liczby przyjazdów, wpływów z turystyki i PKB w czasie,
- zbadano profile czasowe wybranych krajów, reprezentujących różne typy gospodarek,
- obliczono i opisano rozkład rocznych stóp wzrostu liczby przyjazdów i PKB,
- wstępnie przeanalizowano wpływ wybranych epizodów kryzysowych na dynamikę ruchu turystycznego.

Wnioski z tej części EDA pomogą zdecydować, czy w modelach lepiej pracować na poziomach zmiennych (po logarytmowaniu), czy na ich dynamikach oraz jak uwzględnić potencjalne efekty szoków gospodarczych.
